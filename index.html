<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì œ15íšŒ SNUPOOLë°° ëŒ€í•™ë¶€ ìˆ˜ì˜ëŒ€íšŒ ì´ë²¤íŠ¸ê²Œì„ Â· 4:4 ëœë¤ íŒë‹¤ë¦¬ê¸°</title>
  <meta name="description" content="ì „ì²´í™”ë©´ìœ¼ë¡œ ì¦ê¸°ëŠ” ì‹¤ì‹œê°„ ëœë¤ íŒ€ ë°°ì •: ë¬¼ê°œ/ìˆ˜ë‹¬/ëŒê³ ë˜/ì¹´í”¼ë°”ë¼. íŒì—…ìœ¼ë¡œ ì°¸ê°€ì ì…ë ¥, íŒ€ë³„ ë‹¨ì¼ ì¶”ì²¨ ì• ë‹ˆë©”ì´ì…˜, ê²°ì› êµì²´ ì§€ì›." />
  <style>
    :root{
      --bg:#080a12; --panel:#111423; --panel2:#151a2d; --muted:#a7b0c3; --text:#eef2ff; --accent:#60a5fa; --accent2:#22d3ee; --ring:rgba(96,165,250,.35);
      --ok:#34d399; --warn:#f59e0b; --err:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; background:radial-gradient(1200px 600px at 10% -10%, #0f1730 0%, #080a12 45%, #070910 100%); color:var(--text); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, Arial, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif; font-size:clamp(18px,1.8vw,22px)}

    /* âœ… GitHub Pages ì¤‘ë³µ ë Œë”ë§ ê°€ë“œ: ì²« ë²ˆì§¸ ì¸ìŠ¤í„´ìŠ¤ë§Œ í‘œì‹œ */
    body > .wrap:not(:first-of-type),
    body > #confetti:not(:first-of-type),
    body > .modal:not(:first-of-type),
    body > .drawStage:not(:first-of-type){ display:none !important; }

    .wrap{max-width:1400px; margin:0 auto; padding:26px 22px 100px}

    header{display:flex; align-items:center; gap:18px; flex-wrap:wrap}
    header .title{flex:1 1 auto}
    h1{margin:.2rem 0 0; font-size:clamp(2.2rem,5.2vw,3.6rem)}
    .sub{color:#c7d2fe; font-weight:800; letter-spacing:.2px; font-size:clamp(1.2rem,1.8vw,1.4rem)}
    .toolbar{display:flex; gap:12px; flex-wrap:wrap}

    .btn{appearance:none; border:1px solid #2a3557; background:linear-gradient(180deg,#1a2140,#121833); color:#eaf0ff; padding:14px 18px; border-radius:14px; cursor:pointer; font-weight:900; letter-spacing:.2px; transition:.18s transform,.18s opacity,.18s background; font-size:clamp(1.1rem,1.8vw,1.3rem)}
    .btn:hover{transform:translateY(-1px)}
    .btn[disabled]{opacity:.6; cursor:not-allowed}
    .btn.primary{background:linear-gradient(180deg,#3157d3,#2345b3)}
    .btn.ghost{background:transparent}
    .btn.warn{background:linear-gradient(180deg,#8a5a09,#6a4307); border-color:#6a4307}

    .card{border:1px solid #1f2745; background:linear-gradient(180deg,#131a34,#0f152b); border-radius:22px; overflow:hidden; box-shadow:0 8px 30px rgba(0,0,0,.35)}
    .card .head{display:flex; align-items:center; justify-content:space-between; padding:16px 20px; border-bottom:1px solid #1b2342; background:radial-gradient(1200px 300px at -50% -80%, rgba(96,165,250,.12), transparent 60%)}
    .card .head h3{margin:0; font-size:clamp(1.3rem,2vw,1.6rem)}
    .card .body{padding:20px}

    .teams{display:grid; grid-template-columns:repeat(2,1fr); gap:20px}
    @media(max-width:980px){ .teams{grid-template-columns:1fr} }
    .team{border:1px solid #242c54; border-radius:20px; background:linear-gradient(180deg,#141a36,#12162d); transition:.2s transform,.2s border-color}
    .team:hover{transform:translateY(-2px); border-color:#334072}
    .team .th{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:16px 18px; border-bottom:1px dashed #212a4e}
    .team .th h4{margin:0; font-size:clamp(2.0rem,3.2vw,2.6rem)}
    .team .th .right{display:flex; align-items:center; gap:10px}
    .team .count{color:#cbd5e1; font-size:clamp(1.1rem,1.6vw,1.4rem)}
    .team .th .right .btn{padding:10px 14px; font-size:clamp(1rem,1.6vw,1.2rem)}
    .chips{display:flex; gap:12px; flex-wrap:wrap; padding:18px 18px}
    .chip{border:1px solid #2a3557; background:#0e1430; padding:.55rem .9rem; border-radius:999px; font-size:clamp(1.6rem,2.6vw,2.2rem)}
    .emptyChip{opacity:.6}

    .statbar{display:flex; gap:12px; flex-wrap:wrap; margin-top:12px}
    .pill{border:1px solid #2a3557; border-radius:999px; padding:.4rem .9rem; font-size:clamp(1.05rem,1.6vw,1.2rem); color:#dbeafe}

    .toast{position:fixed; left:50%; transform:translateX(-50%); bottom:28px; background:#10213a; border:1px solid #274165; padding:12px 16px; border-radius:12px; color:#dbeafe; z-index:60; box-shadow:0 8px 24px rgba(0,0,0,.35); display:none; font-size:clamp(1.05rem,1.6vw,1.2rem)}

    /* --- Modals (input/team/draw) --- */
    .modal{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:50}
    .modal.show{display:flex}
    .backdrop{position:absolute; inset:0; background:rgba(5,8,20,.7); backdrop-filter:blur(2px)}
    .sheet{position:relative; width:min(1100px,92vw); max-height:88vh; overflow:auto; border-radius:22px; border:1px solid #2a335a; background:linear-gradient(180deg,#121734,#0c1129); box-shadow:0 20px 80px rgba(0,0,0,.55)}

    /* Input modal */
    .sheet .hd{display:flex; align-items:center; justify-content:space-between; padding:20px 22px; border-bottom:1px solid #1c2446}
    .sheet .hd h3{margin:0; font-size:clamp(1.6rem,2.4vw,2rem)}
    .sheet .bd{padding:20px 22px}
    textarea{width:100%; min-height:320px; resize:vertical; padding:18px; border-radius:16px; border:1px solid #273055; background:#0d1330; color:var(--text); line-height:1.55; font-size:clamp(1.3rem,1.9vw,1.6rem)}
    textarea:focus{outline:none; box-shadow:0 0 0 4px var(--ring)}

    /* Team modal */
    .biglist{padding:24px}
    .bigrow{display:flex; align-items:center; justify-content:space-between; gap:18px; border:1px solid #263161; background:linear-gradient(180deg,#141b3f,#10163a); border-radius:18px; padding:22px; margin:14px 0}
    .bigname{font-size:clamp(3.2rem,7.6vw,6.4rem); font-weight:900; letter-spacing:.3px}
    .bigrow .actions{display:flex; gap:12px; align-items:center}
    .xbtn{appearance:none; border:1px solid #3a2540; background:linear-gradient(180deg,#401a25,#2a1016); color:#ffd7d7; padding:.7rem 1rem; border-radius:14px; cursor:pointer; font-weight:900; font-size:clamp(1.2rem,1.6vw,1.4rem)}
    .fillbtn{appearance:none; border:1px solid #244a3a; background:linear-gradient(180deg,#135f43,#0e4a34); color:#d1fae5; padding:.8rem 1.1rem; border-radius:14px; cursor:pointer; font-weight:900; font-size:clamp(1.2rem,1.6vw,1.4rem)}

    /* Draw overlay */
    .drawStage{position:fixed; inset:0; display:none; place-items:center; background:radial-gradient(1000px 400px at 50% -10%, rgba(34,211,238,.12), transparent 50%), radial-gradient(1200px 500px at 20% 120%, rgba(96,165,250,.15), transparent 60%), #070a14; z-index:70}
    .drawStage.show{display:grid}
    .drawInner{text-align:center}
    .drawTitle{font-size:clamp(2.2rem,4.6vw,3.2rem); margin:0 0 18px}
    .ticker{font-size:clamp(3.4rem,9.2vw,7.2rem); font-weight:900; letter-spacing:.8px}
    .ticker span{display:inline-block; animation:pop .15s ease}
    @keyframes pop{0%{transform:scale(1)} 50%{transform:scale(1.06)} 100%{transform:scale(1)}}

    .confetti{position:fixed; inset:0; pointer-events:none; overflow:hidden}
    .confetti span{position:absolute; top:-10px; font-size:18px; animation:drop 2.2s linear forwards; opacity:.95}
    @keyframes drop{to{transform:translateY(105vh) rotate(540deg); opacity:.9}}

    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; border:1px solid #2a2f45; background:#101428; padding:.12rem .5rem; border-radius:6px}
  </style>
</head>
<body>
  <div class="confetti" id="confetti" aria-hidden="true"></div>
  <div class="wrap">
    <header>
      <div class="title">
        <div class="sub">ì œ15íšŒ SNUPOOLë°° ëŒ€í•™ë¶€ ìˆ˜ì˜ëŒ€íšŒ Â· ì´ë²¤íŠ¸ ê²Œì„</div>
        <h1>4:4 ëœë¤ íŒë‹¤ë¦¬ê¸°</h1>
      </div>
      <div class="toolbar">
        <button class="btn" id="btnFullscreen" type="button">â›¶ ì „ì²´í™”ë©´</button>
        <button class="btn" id="btnOpenInput" type="button">âœï¸ ì°¸ê°€ì ì…ë ¥</button>
        <!-- ì „ì—­ ì¶”ì²¨ ë²„íŠ¼ ì œê±°: íŒ€ë³„ ì¹´ë“œ ë‚´ì—ì„œ ê°œë³„ ì¶”ì²¨ -->
      </div>
    </header>

    <section class="card" style="margin-top:12px">
      <div class="head">
        <h3>íŒ€ í˜„í™©</h3>
        <div class="statbar">
          <span class="pill" id="statTotal">ì´ ì°¸ê°€ì 0ëª…</span>
          <span class="pill" id="statUnique">ì¤‘ë³µ ì œê±° í›„ 0ëª…</span>
          <span class="pill" id="statBench">ë¯¸ì„ ë°œ 0ëª…</span>
        </div>
      </div>
      <div class="body">
        <div class="teams" id="teams"></div>
      </div>
    </section>

    <div class="toast" id="toast"></div>
  </div>

  <!-- ì°¸ê°€ì ì…ë ¥ ëª¨ë‹¬ -->
  <div class="modal" id="inputModal" role="dialog" aria-modal="true">
    <div class="backdrop" data-close="input"></div>
    <div class="sheet" role="document">
      <div class="hd">
        <h3>ì°¸ê°€ì ì…ë ¥</h3>
      </div>
      <div class="bd">
        <textarea id="names" placeholder="ì´ë¦„ì„ ì‰¼í‘œ ë˜ëŠ” ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„í•´ ë¶™ì—¬ë„£ê¸°"></textarea>
        <div style="display:flex; gap:12px; align-items:center; justify-content:flex-end; margin-top:14px">
          <button class="btn" id="btnSaveNames" type="button">ì €ì¥</button>
          <button class="btn warn" id="btnCloseInput" type="button">ë‹«ê¸°</button>
        </div>
      </div>
    </div>
  </div>

  <!-- íŒ€ ìƒì„¸ ëª¨ë‹¬ -->
  <div class="modal" id="teamModal" role="dialog" aria-modal="true">
    <div class="backdrop" data-close="team"></div>
    <div class="sheet" role="document" style="width:min(1200px,94vw)">
      <div class="hd">
        <h3 id="teamTitle">íŒ€ ìƒì„¸</h3>
        <div>
          <button class="btn warn" id="btnCloseTeam" type="button">ë‹«ê¸°</button>
        </div>
      </div>
      <div class="biglist" id="teamList"></div>
    </div>
  </div>

  <!-- ì¶”ì²¨ ì• ë‹ˆë©”ì´ì…˜ ì˜¤ë²„ë ˆì´ -->
  <div class="drawStage" id="drawStage">
    <div class="drawInner">
      <h2 class="drawTitle" id="drawTitle">ì¶”ì²¨ì¤‘â€¦ ì ì‹œë§Œìš”!</h2>
      <div class="ticker" id="ticker">ì‹œì‘í•©ë‹ˆë‹¤</div>
    </div>
  </div>

<script>
(function(){
  if (window.__SNUPOOL_444_INIT__) return;
  window.__SNUPOOL_444_INIT__ = true;

  function q(s, el){ return (el||document).querySelector(s); }

  var TEAM_INFO = [
    {key:'ë¬¼ê°œ', emoji:'ğŸ¦­'},
    {key:'ìˆ˜ë‹¬', emoji:'ğŸ¦¦'},
    {key:'ëŒê³ ë˜', emoji:'ğŸ¬'},
    {key:'ì¹´í”¼ë°”ë¼', emoji:'ğŸ¹'}
  ];

  var LS_KEY = 'snupool_random_444_v_teamwise_v3';
  var state = { participants: [], teams: [[],[],[],[]] };

  var teamsEl = q('#teams');
  var statTotal = q('#statTotal');
  var statUnique = q('#statUnique');
  var statBench = q('#statBench');
  var toast = q('#toast');
  var inputModal = q('#inputModal');
  var namesEl = q('#names');
  var teamModal = q('#teamModal');
  var teamTitle = q('#teamTitle');
  var teamList = q('#teamList');
  var drawStage = q('#drawStage');
  var drawTitle = q('#drawTitle');
  var ticker = q('#ticker');

  function showToast(msg){
    if(!toast) return; toast.textContent = msg; toast.style.display = 'block';
    clearTimeout(showToast._t); showToast._t = setTimeout(function(){ toast.style.display='none'; }, 2200);
  }
  function saveLS(){ try{ localStorage.setItem(LS_KEY, JSON.stringify({text:(namesEl && namesEl.value)||''})); }catch(e){} }
  function loadLS(){ try{ var s = JSON.parse(localStorage.getItem(LS_KEY)||'null'); if(s && s.text && namesEl){ namesEl.value = s.text; } }catch(e){} }

  function parseNames(){
    var raw = (namesEl && namesEl.value ? namesEl.value : '');
    raw = raw.split('
').join(',');
    var parts = raw.split(',');
    var uniq = [], seen = {};
    for (var i=0;i<parts.length;i++){
      var x = parts[i].trim();
      if(!x) continue;
      if(!seen[x]){ seen[x]=1; uniq.push(x); }
    }
    if(statTotal) statTotal.textContent = 'ì´ ì°¸ê°€ì ' + parts.filter(function(x){return x.trim();}).length + 'ëª…';
    if(statUnique) statUnique.textContent = 'ì¤‘ë³µ ì œê±° í›„ ' + uniq.length + 'ëª…';
    return uniq;
  }

  function flattenAssigned(){
    var out=[];
    for (var t=0;t<4;t++){
      var row = state.teams[t];
      for (var i=0;i<4;i++){ var v=row[i]; if(v) out.push(v); }
    }
    return out;
  }
  function computePool(){
    var assigned = {};
    var a = flattenAssigned();
    for (var i=0;i<a.length;i++){ assigned[a[i]] = 1; }
    var pool=[];
    for (var j=0;j<state.participants.length;j++){
      var n = state.participants[j]; if(!assigned[n]) pool.push(n);
    }
    return pool;
  }
  function nextEmptyIndex(tIdx){ for (var i=0;i<4;i++){ if(!state.teams[tIdx][i]) return i; } return -1; }
  function rand(n){ return Math.floor(Math.random()*n); }

  function renderTeams(){
    if(!teamsEl) return;
    teamsEl.innerHTML='';
    for (var idx=0; idx<4; idx++){
      var info = TEAM_INFO[idx];
      var box = document.createElement('div'); box.className='team'; box.setAttribute('data-idx',''+idx);

      var head = document.createElement('div'); head.className='th';
      var title = document.createElement('h4');
      var emo = document.createElement('span'); emo.textContent = info.emoji; emo.style.marginRight='12px';
      title.appendChild(emo); title.appendChild(document.createTextNode(info.key + ' íŒ€'));
      var right = document.createElement('div'); right.className='right';
      var btn = document.createElement('button'); btn.className='btn teamDraw'; btn.setAttribute('data-team',''+idx); btn.textContent='ğŸ² 1ëª… ë½‘ê¸°';
      var countEl = document.createElement('div'); countEl.className='count'; countEl.textContent = state.teams[idx].filter(Boolean).length + '/4';
      right.appendChild(btn); right.appendChild(countEl);
      head.appendChild(title); head.appendChild(right);

      var chips = document.createElement('div'); chips.className='chips';
      for (var i=0;i<4;i++){
        var name = state.teams[idx][i];
        var sp = document.createElement('span'); sp.className = 'chip' + (name?'' : ' emptyChip'); sp.textContent = name || 'ë¹ˆ ìë¦¬'; chips.appendChild(sp);
      }

      box.appendChild(head); box.appendChild(chips);
      box.addEventListener('click', function(e){
        var t = e.target; while(t && t.tagName !== 'BUTTON') t = t.parentElement;
        if (t && t.classList && t.classList.contains('teamDraw')) return;
        var idx = parseInt(this.getAttribute('data-idx'),10); openTeam(idx);
      });
      teamsEl.appendChild(box);
    }
    if(statBench) statBench.textContent = 'ë¯¸ì„ ë°œ ' + computePool().length + 'ëª…';
  }

  function animateDraw(list, title){
    drawTitle.textContent = title || 'ì¶”ì²¨ì¤‘â€¦';
    drawStage.classList.add('show');
    var count=0;
    var id = setInterval(function(){
      var name = list[rand(list.length)] || 'â€”';
      ticker.innerHTML=''; var s=document.createElement('span'); s.textContent=name; ticker.appendChild(s);
      count++; if(count>=26){ clearInterval(id); }
    }, 80);
    return new Promise(function(res){ setTimeout(function(){ drawStage.classList.remove('show'); res(); }, 2200); });
  }

  async function drawOneForTeam(tIdx){
    if(state.participants.length === 0){ showToast('ë¨¼ì € ì°¸ê°€ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); openInput(); return; }
    var slot = nextEmptyIndex(tIdx); if(slot === -1){ showToast('ì´ë¯¸ 4ëª…ì´ ëª¨ë‘ ë°°ì •ë˜ì—ˆìŠµë‹ˆë‹¤.'); return; }
    var pool = computePool(); if(pool.length === 0){ showToast('ë½‘ì„ ì¸ì›ì´ ì—†ìŠµë‹ˆë‹¤.'); return; }
    var info = TEAM_INFO[tIdx];
    await animateDraw(pool, info.emoji+' '+info.key+' íŒ€ ì¶”ì²¨ì¤‘â€¦');
    var pick = pool[rand(pool.length)];
    state.teams[tIdx][slot] = pick;
    renderTeams();
    burstConfetti();
  }

  function openTeam(idx){
    teamTitle.textContent = TEAM_INFO[idx].emoji + ' ' + TEAM_INFO[idx].key + ' íŒ€';
    teamList.innerHTML='';
    for(var i=0;i<4;i++){
      var row = document.createElement('div'); row.className='bigrow'; row.setAttribute('data-pos',''+i); row.setAttribute('data-team',''+idx);
      var left = document.createElement('div'); left.className='bigname'; left.textContent = state.teams[idx][i] || 'â€” ë¹ˆ ìë¦¬ â€”';
      var right = document.createElement('div'); right.className='actions';
      if(state.teams[idx][i]){
        var x = document.createElement('button'); x.className='xbtn'; x.textContent='âœ• ì œê±°'; x.addEventListener('click', (function(ti,pi){ return function(){ removeMember(ti,pi); };})(idx,i)); right.appendChild(x);
      } else {
        var f = document.createElement('button'); f.className='fillbtn'; f.textContent='ìƒˆ ì„ ìˆ˜ ë½‘ê¸°'; f.addEventListener('click', (function(ti,pi,btn){ return function(){ fillVacancy(ti,pi,btn); };})(idx,i,f)); right.appendChild(f);
      }
      row.appendChild(left); row.appendChild(right); teamList.appendChild(row);
    }
    teamModal.classList.add('show');
  }
  function closeTeam(){ teamModal.classList.remove('show'); }

  function removeMember(tIdx, pos){
    var name = state.teams[tIdx][pos]; if(!name) return;
    state.teams[tIdx][pos] = null;
    showToast(TEAM_INFO[tIdx].key + ' íŒ€: ' + name + ' ì œê±°ë¨');
    renderTeams(); openTeam(tIdx);
  }

  function fillVacancy(tIdx, pos, btnEl){
    var pool = computePool(); if(pool.length===0){ showToast('ë½‘ì„ ì¸ì›ì´ ì—†ìŠµë‹ˆë‹¤.'); return; }
    var id = setInterval(function(){ btnEl.textContent = pool[rand(pool.length)] || 'ì¶”ì²¨ ì¤‘â€¦'; }, 80);
    btnEl.disabled = true;
    setTimeout(function(){
      clearInterval(id);
      var pick = pool[rand(pool.length)];
      state.teams[tIdx][pos] = pick;
      renderTeams(); openTeam(tIdx); burstConfetti();
    }, 1000);
  }

  function burstConfetti(){
    var root = q('#confetti'); var EMO=['ğŸ‰','ğŸŠ','âœ¨','ğŸ’«','ğŸŒŸ'];
    for(var i=0;i<60;i++){
      var s=document.createElement('span'); s.textContent=EMO[rand(EMO.length)]; s.style.left=(Math.random()*100)+'%'; s.style.animationDelay=(Math.random()*0.6)+'s'; s.style.fontSize=(16+Math.random()*22)+'px'; root.appendChild(s); setTimeout((function(el){ return function(){ el.parentNode && el.parentNode.removeChild(el); };})(s),2400);
    }
  }

  function openInput(){ inputModal.classList.add('show'); }
  function closeInput(){ inputModal.classList.remove('show'); }

  document.addEventListener('click', function(e){
    var t = e.target; while(t && t.tagName !== 'BUTTON') t = t.parentElement; if(!t) return;
    var id = t.id;
    if(id==='btnOpenInput'){ openInput(); return; }
    if(id==='btnCloseInput'){ closeInput(); return; }
    if(id==='btnSaveNames'){ var u=parseNames(); state.participants=u.slice(0); saveLS(); showToast(u.length+'ëª… ì €ì¥ë¨'); renderTeams(); return; }
    if(id==='btnCloseTeam'){ closeTeam(); return; }
    if(id==='btnFullscreen'){
      try{ if(!document.fullscreenElement){ document.documentElement.requestFullscreen(); } else { document.exitFullscreen(); } }catch(e){ showToast('ì „ì²´í™”ë©´ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. F11 í‚¤ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.'); }
      return;
    }
    if(t.classList.contains('teamDraw')){ var team=parseInt(t.getAttribute('data-team'),10); drawOneForTeam(team); return; }
  });

  if(namesEl){ namesEl.addEventListener('input', saveLS); namesEl.addEventListener('keydown', function(e){ if((e.metaKey||e.ctrlKey) && e.key==='Enter'){ e.preventDefault(); var b=document.getElementById('btnSaveNames'); if(b) b.click(); } }); }

  loadLS(); state.participants = parseNames().slice(0); renderTeams();
})();
</script>
</body>
</html>
