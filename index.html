<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì œ15íšŒ SNUPOOLë°° ëŒ€í•™ë¶€ ìˆ˜ì˜ëŒ€íšŒ ì´ë²¤íŠ¸ê²Œì„ Â· 4:4 ëœë¤ íŒë‹¤ë¦¬ê¸°</title>
  <meta name="description" content="ì°¸ê°€ì ëª…ë‹¨ì„ ë„£ìœ¼ë©´ íŒ€ë‹¹ 4ëª…ì”©, ì´ 16ëª…ì„ ëœë¤ìœ¼ë¡œ ì¶”ì²¨í•˜ì—¬ ë¬¼ê°œ/ìˆ˜ë‹¬/ëŒê³ ë˜/ì¹´í”¼ë°”ë¼ íŒ€ìœ¼ë¡œ ë°°ì •í•©ë‹ˆë‹¤. ëª¨ë“  ì²˜ë¦¬ëŠ” ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì´ë¤„ì§‘ë‹ˆë‹¤." />
  <style>
    :root{
      --bg:#0b0b10; --panel:#15151d; --muted:#9aa1af; --text:#f2f4f8; --brand:#60a5fa; --accent:#22d3ee;
      --ok:#34d399; --warn:#fbbf24; --err:#f87171; --ring:rgba(96,165,250,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, Arial, "Apple SD Gothic Neo", "Malgun Gothic", sans-serif; background:linear-gradient(180deg,#0b0b10,#0f1016 40%,#0b0b10); color:var(--text);}
    .wrap{max-width:1100px; margin:0 auto; padding:28px 18px 80px}
    header h1{margin:.2rem 0 0; font-size:clamp(1.4rem,4vw,2rem); letter-spacing:.2px}
    header p{margin:.25rem 0 0; color:var(--muted)}
    header .badge{display:inline-flex; gap:.5rem; align-items:center; margin-top:.6rem; padding:.25rem .6rem; border:1px solid #273045; background:#0f1423; border-radius:999px; font-size:.9rem; color:#c9d5ff}
    .grid{display:grid; gap:18px; grid-template-columns:1.1fr .9fr}
    @media(max-width:920px){ .grid{grid-template-columns:1fr} }

    .card{background:linear-gradient(180deg,#13141c,#0f1016); border:1px solid #222536; border-radius:18px; box-shadow:0 6px 20px rgba(0,0,0,.35); overflow:hidden}
    .card .head{display:flex; align-items:center; justify-content:space-between; padding:14px 16px; border-bottom:1px solid #1e2232; background:radial-gradient(1200px 300px at -50% -100%, rgba(96,165,250,.12), transparent 50%) }
    .card .head h3{margin:0; font-weight:700; font-size:1.05rem}
    .card .body{padding:16px}

    textarea{width:100%; min-height:220px; resize:vertical; padding:14px 14px 34px; border-radius:14px; border:1px solid #262b3d; outline:none; background:#0e111a; color:var(--text); line-height:1.5}
    textarea:focus{border-color:#2d6eea; box-shadow:0 0 0 5px var(--ring)}
    .row{display:flex; flex-wrap:wrap; gap:10px; align-items:center}
    .hint{font-size:.9rem; color:var(--muted)}

    .btn{appearance:none; border:1px solid #273045; background:linear-gradient(180deg,#1b2132,#111522); color:#e8eefc; padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600; transition:.2s transform,.2s opacity,.2s border-color}
    .btn:focus{outline:none; box-shadow:0 0 0 5px var(--ring)}
    .btn:hover{transform:translateY(-1px); border-color:#334063}
    .btn[disabled]{opacity:.5; cursor:not-allowed}
    .btn.primary{border-color:#3b5ccc; background:linear-gradient(180deg,#3056c7,#2043a8)}
    .btn.ghost{background:transparent}
    .btn.success{background:linear-gradient(180deg,#16a34a,#15803d); border-color:#1a6b3d}

    .opt{display:flex; gap:10px; align-items:center}
    .opt input[type="text"]{height:38px; padding:0 10px; border-radius:10px; border:1px solid #262b3d; background:#0e111a; color:var(--text)}

    .teams{display:grid; grid-template-columns:repeat(2,1fr); gap:14px}
    @media(max-width:700px){ .teams{grid-template-columns:1fr} }
    .team{border:1px solid #24273a; border-radius:16px; background:linear-gradient(180deg,#141721,#101320)}
    .team .th{display:flex; align-items:center; justify-content:space-between; padding:10px 14px; border-bottom:1px solid #202335}
    .team .th h4{margin:0; font-size:1.05rem}
    .team .th .emoji{font-size:1.2rem}
    .team ol{margin:0; padding:12px 20px 18px 28px}
    .team ol li{margin:.3rem 0; padding:.15rem 0}

    .muted{color:var(--muted)}
    .stat{display:flex; gap:10px; flex-wrap:wrap}
    .pill{border:1px solid #273045; border-radius:999px; padding:.2rem .65rem; font-size:.9rem; color:#cbd5e1}

    .footer{margin-top:18px; display:flex; gap:10px; flex-wrap:wrap}

    .alert{margin-top:10px; padding:10px 12px; border:1px solid #3a2a2a; background:#1a1010; color:#ffd1d1; border-radius:12px}

    .confetti{position:fixed; inset:0; pointer-events:none; overflow:hidden}
    .confetti span{position:absolute; top:-10px; font-size:16px; animation:drop 2.2s linear forwards; opacity:.95}
    @keyframes drop{to{transform:translateY(105vh) rotate(540deg); opacity:.9}}

    .small{font-size:.88rem}
    .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; border:1px solid #2a2f45; background:#101428; padding:.08rem .4rem; border-radius:6px}

    .ghostline{border-top:1px dashed #2a2f45; margin:12px 0}
  </style>
</head>
<body>
  <div class="confetti" id="confetti" aria-hidden="true"></div>
  <div class="wrap">
    <header>
      <div class="badge">ì œ15íšŒ SNUPOOLë°° ëŒ€í•™ë¶€ ìˆ˜ì˜ëŒ€íšŒ Â· ì´ë²¤íŠ¸ ê²Œì„</div>
      <h1>4:4 ëœë¤ íŒë‹¤ë¦¬ê¸°</h1>
      <p class="small">ì°¸ê°€ì í…ìŠ¤íŠ¸ë¥¼ ë¶™ì—¬ë„£ê³  <span class="kbd">ì¶”ì²¨</span>ì„ ëˆ„ë¥´ë©´ ë¬¼ê°œ/ìˆ˜ë‹¬/ëŒê³ ë˜/ì¹´í”¼ë°”ë¼ íŒ€ìœ¼ë¡œ 4ëª…ì”©, ì´ 16ëª…ì„ ìë™ ë°°ì •í•©ë‹ˆë‹¤. ëª¨ë“  ì²˜ë¦¬ëŠ” ë¸Œë¼ìš°ì €ì—ì„œë§Œ ì´ë¤„ì§‘ë‹ˆë‹¤.</p>
    </header>

    <div class="grid" role="main">
      <section class="card" aria-labelledby="input-head">
        <div class="head"><h3 id="input-head">ì°¸ê°€ì ì…ë ¥</h3>
          <div class="row">
            <button class="btn ghost small" id="btnSample" type="button">ì˜ˆì‹œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
          </div>
        </div>
        <div class="body">
          <label for="names" class="hint">ì‰¼í‘œ(,) ë˜ëŠ” ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„ Â· ê³µë°±/ì¤‘ë³µ ìë™ ì •ë¦¬</label>
          <textarea id="names" placeholder="ì˜ˆ) í™ê¸¸ë™, ê¹€ì˜í¬, ì´ì² ìˆ˜, ..."></textarea>
          <div class="ghostline"></div>
          <div class="row" style="justify-content:space-between">
            <div class="stat">
              <span class="pill" id="statTotal">ì´ ì…ë ¥ 0ëª…</span>
              <span class="pill" id="statUnique">ì¤‘ë³µ ì œê±° í›„ 0ëª…</span>
              <span class="pill" id="statDup" title="ì¤‘ë³µìœ¼ë¡œ ì œê±°ëœ ìˆ˜">ì¤‘ë³µ 0ëª…</span>
            </div>
            <div class="opt">
              <label class="small" for="seed">ì‹œë“œ(ì„ íƒ):</label>
              <input type="text" id="seed" placeholder="ê°™ì€ ì‹œë“œ = ê°™ì€ ê²°ê³¼" />
              <label class="small" style="display:flex; gap:6px; align-items:center">
                <input type="checkbox" id="dedupe" checked /> ì¤‘ë³µ ì œê±°
              </label>
            </div>
          </div>
          <div class="footer">
            <button class="btn primary" id="btnDraw" type="button">ğŸ² ëœë¤ ì¶”ì²¨ (16ëª… ì„ ë°œ)</button>
            <button class="btn" id="btnShuffle" type="button">ğŸ” ë‹¤ì‹œ ì„ê¸°</button>
            <button class="btn ghost" id="btnClear" type="button">ğŸ§¹ ì´ˆê¸°í™”</button>
          </div>
          <div id="alert" class="alert" style="display:none"></div>
        </div>
      </section>

      <section class="card" aria-labelledby="result-head">
        <div class="head"><h3 id="result-head">ê²°ê³¼</h3>
          <div class="row">
            <button class="btn small" id="btnCopy" type="button">ğŸ“‹ ê²°ê³¼ ë³µì‚¬</button>
            <button class="btn small" id="btnCSV" type="button">â¬‡ï¸ CSV ë‹¤ìš´ë¡œë“œ</button>
          </div>
        </div>
        <div class="body">
          <div class="teams" id="teams"></div>
          <div id="benchWrap" style="margin-top:10px; display:none">
            <div class="ghostline"></div>
            <p class="muted small" id="benchTitle">ë¯¸ì„ ë°œ ëª…ë‹¨ (0ëª…)</p>
            <div id="bench" class="small"></div>
          </div>
        </div>
      </section>
    </div>

    <footer style="margin-top:22px; color:var(--muted)" class="small">
      íŒ: <span class="kbd">Cmd/Ctrl + Enter</span> ë¡œ ì¦‰ì‹œ ì¶”ì²¨ Â· ì…ë ¥ ë‚´ìš©ì€ ë¡œì»¬ì— ìë™ ì €ì¥ë©ë‹ˆë‹¤.
    </footer>
  </div>

<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const namesEl = $('#names');
  const dedupeEl = $('#dedupe');
  const seedEl = $('#seed');
  const alertEl = $('#alert');
  const teamsEl = $('#teams');
  const benchEl = $('#bench');
  const benchWrapEl = $('#benchWrap');
  const statTotal = $('#statTotal');
  const statUnique = $('#statUnique');
  const statDup = $('#statDup');
  const TEAM_INFO = [
    { key:'ë¬¼ê°œ', emoji:'ğŸ¦­' },
    { key:'ìˆ˜ë‹¬', emoji:'ğŸ¦¦' },
    { key:'ëŒê³ ë˜', emoji:'ğŸ¬' },
    { key:'ì¹´í”¼ë°”ë¼', emoji:'ğŸ¹' }, // ì¹´í”¼ë°”ë¼ ì´ëª¨ì§€ ë¶€ì¬ë¡œ ëŒ€ì²´
  ];

  // --- LocalStorage hydration ---
  const LS_KEY = 'snupool_random_pandarigi_v1';
  try{ const saved = JSON.parse(localStorage.getItem(LS_KEY)||'null'); if(saved && saved.text){ namesEl.value = saved.text; seedEl.value = saved.seed||''; dedupeEl.checked = !!saved.dedupe; } }catch(e){}

  // --- Utility: seeded RNG (xmur3 + mulberry32) ---
  function xmur3(str){ let h=1779033703 ^ str.length; for(let i=0;i<str.length;i++){ h = Math.imul(h ^ str.charCodeAt(i), 3432918353); h = (h<<13) | (h>>>19); } return function(){ h = Math.imul(h ^ (h>>>16), 2246822507); h = Math.imul(h ^ (h>>>13), 3266489909); return (h ^= h>>>16)>>>0; } }
  function mulberry32(a){ return function(){ let t = a += 0x6D2B79F5; t = Math.imul(t ^ (t>>>15), t | 1); t ^= t + Math.imul(t ^ (t>>>7), t | 61); return ((t ^ (t>>>14)) >>> 0) / 4294967296; } }
  function rngFromSeed(seed){ if(!seed) return Math.random; const seedFn = xmur3(String(seed)); const r = mulberry32(seedFn()); return r; }

  // --- Parse input ---
  function parseNames(){
    const raw = namesEl.value.replace(/\n/g, ',');
    const arr = raw.split(',').map(s=>s.trim()).filter(Boolean);
    const total = arr.length;
    let unique = arr;
    let dups = 0;
    if(dedupeEl.checked){
      const seen = new Set();
      unique = [];
      for(const n of arr){ if(!seen.has(n)){ unique.push(n); seen.add(n); } else { dups++; } }
    }
    statTotal.textContent = `ì´ ì…ë ¥ ${total}ëª…`;
    statUnique.textContent = `ì¤‘ë³µ ì œê±° í›„ ${unique.length}ëª…`;
    statDup.textContent = `ì¤‘ë³µ ${dups}ëª…`;
    return unique;
  }

  function saveLS(){
    try{ localStorage.setItem(LS_KEY, JSON.stringify({ text:namesEl.value, seed:seedEl.value, dedupe:dedupeEl.checked })); }catch(e){}
  }

  namesEl.addEventListener('input', ()=>{ parseNames(); saveLS(); });
  dedupeEl.addEventListener('change', ()=>{ parseNames(); saveLS(); });
  seedEl.addEventListener('input', saveLS);

  // --- Shuffle & pick ---
  function shuffleInPlace(a, rnd){ for(let i=a.length-1;i>0;i--){ const j = Math.floor(rnd()* (i+1)); [a[i], a[j]] = [a[j], a[i]]; } return a; }

  function draw(){
    clearAlert();
    const list = parseNames();
    if(list.length < 16){
      showAlert(`ì°¸ê°€ìê°€ ${list.length}ëª…ì…ë‹ˆë‹¤. ìµœì†Œ 16ëª…ì´ í•„ìš”í•©ë‹ˆë‹¤.`, 'err');
      renderTeams([]); renderBench([]); return;
    }
    const rnd = rngFromSeed(seedEl.value.trim());
    const pool = list.slice();
    shuffleInPlace(pool, rnd);
    const selected = pool.slice(0, 16);
    const bench = pool.slice(16);
    renderTeams(selected);
    renderBench(bench);
    burstConfetti();
  }

  function reshuffle(){
    const hasResult = teamsEl.children.length > 0;
    if(!hasResult){ draw(); return; }
    const current = collectCurrentMembers();
    if(current.length !== 16){ draw(); return; }
    const rnd = rngFromSeed(seedEl.value.trim());
    shuffleInPlace(current, rnd);
    renderTeams(current);
    burstConfetti();
  }

  function collectCurrentMembers(){
    const li = teamsEl.querySelectorAll('li');
    return Array.from(li).map(x=>x.textContent.trim()).filter(Boolean);
  }

  function renderTeams(selected){
    teamsEl.innerHTML = '';
    if(selected.length === 0){ return; }
    const teams = [ selected.slice(0,4), selected.slice(4,8), selected.slice(8,12), selected.slice(12,16) ];
    teams.forEach((members, idx)=>{
      const info = TEAM_INFO[idx];
      const box = document.createElement('div'); box.className = 'team';
      const head = document.createElement('div'); head.className = 'th';
      head.innerHTML = `<h4><span class="emoji">${info.emoji}</span> ${info.key} íŒ€</h4><span class="muted small">${members.length}ëª…</span>`;
      const list = document.createElement('ol');
      members.forEach(n=>{ const li = document.createElement('li'); li.textContent = n; list.appendChild(li); });
      box.appendChild(head); box.appendChild(list); teamsEl.appendChild(box);
    });
  }

  function renderBench(bench){
    if(!bench || bench.length===0){ benchWrapEl.style.display='none'; benchEl.textContent=''; return; }
    benchWrapEl.style.display='block';
    $('#benchTitle').textContent = `ë¯¸ì„ ë°œ ëª…ë‹¨ (${bench.length}ëª…)`;
    benchEl.textContent = bench.join(', ');
  }

  function toText(){
    if(teamsEl.children.length===0) return '';
    let out = `ì œ15íšŒ SNUPOOLë°° ì´ë²¤íŠ¸ê²Œì„ - 4:4 ëœë¤ íŒë‹¤ë¦¬ê¸°\n`;
    for(let i=0;i<4;i++){
      const info = TEAM_INFO[i];
      const items = teamsEl.children[i].querySelectorAll('li');
      const names = Array.from(items).map(li=>li.textContent.trim());
      out += `\n[${info.emoji} ${info.key}] ${names.join(', ')}`;
    }
    if(benchEl.textContent.trim()) out += `\n\n(ë¯¸ì„ ë°œ) ${benchEl.textContent.trim()}`;
    return out;
  }

  function toCSV(){
    const rows = [["Team","Member"]];
    for(let i=0;i<4;i++){
      const info = TEAM_INFO[i];
      const items = teamsEl.children[i]?.querySelectorAll('li') || [];
      Array.from(items).forEach(li=> rows.push([info.key, li.textContent.trim()]));
    }
    return rows.map(r=> r.map(s=> '"'+String(s).replace(/"/g,'""')+'"').join(',')).join('\n');
  }

  function copyResult(){
    const txt = toText();
    if(!txt){ showAlert('ë³µì‚¬í•  ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì¶”ì²¨ì„ ì§„í–‰í•˜ì„¸ìš”.','warn'); return; }
    navigator.clipboard.writeText(txt).then(()=>{ showAlert('ê²°ê³¼ë¥¼ í´ë¦½ë³´ë“œì— ë³µì‚¬í–ˆì–´ìš”. ì›í•˜ëŠ” ê³³ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.','ok'); });
  }

  function downloadCSV(){
    if(teamsEl.children.length===0){ showAlert('ë‹¤ìš´ë¡œë“œí•  ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì¶”ì²¨ì„ ì§„í–‰í•˜ì„¸ìš”.','warn'); return; }
    const blob = new Blob(["\ufeff" + toCSV()], {type:'text/csv;charset=utf-8;'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'snupool_random_teams.csv';
    document.body.appendChild(a); a.click(); a.remove();
  }

  function showAlert(msg, type='warn'){
    alertEl.textContent = msg; alertEl.style.display='block';
    alertEl.style.borderColor = type==='ok'? '#1e3b2d' : (type==='err'? '#3a2a2a' : '#3a2f1a');
    alertEl.style.background = type==='ok'? '#0f1d18' : (type==='err'? '#1a1010' : '#181409');
  }
  function clearAlert(){ alertEl.style.display='none'; alertEl.textContent=''; }

  function burstConfetti(){
    const root = $('#confetti');
    const EMO = ['ğŸ‰','ğŸŠ','âœ¨','ğŸ’«','ğŸŒŸ'];
    for(let i=0;i<40;i++){
      const s = document.createElement('span');
      s.textContent = EMO[(Math.random()*EMO.length)|0];
      s.style.left = (Math.random()*100)+'%';
      s.style.animationDelay = (Math.random()*0.6)+'s';
      s.style.fontSize = (12 + Math.random()*18)+'px';
      root.appendChild(s);
      setTimeout(()=> s.remove(), 2400);
    }
  }

  // --- Events ---
  $('#btnDraw').addEventListener('click', draw);
  $('#btnShuffle').addEventListener('click', reshuffle);
  $('#btnClear').addEventListener('click', ()=>{ namesEl.value=''; seedEl.value=''; saveLS(); parseNames(); teamsEl.innerHTML=''; benchEl.textContent=''; benchWrapEl.style.display='none'; clearAlert(); });
  $('#btnCopy').addEventListener('click', copyResult);
  $('#btnCSV').addEventListener('click', downloadCSV);
  $('#btnSample').addEventListener('click', ()=>{
    const demo = 'í™ê¸¸ë™, ê¹€ì˜í¬, ì´ì² ìˆ˜, ë°•ë¯¼ìˆ˜, ìµœìˆ˜ì •, ì˜¤ì„¸í›ˆ, ìœ í•˜ëŠ˜, ë¬¸íƒœì–‘, ì‹ ë³„, ì´ë¹›ë‚˜, ê°•ì§€ìš°, ì¥ì„œìœ¤, ë…¸ê±´ìš°, ê¹€ë„ìœ¤, í•œì§€ë¯¼, ìœ¤ì˜ˆì§„, ì¡°ì•„ë¼, ì„œí•œê²°, í‘œìŠ¹í˜„, ì •ì±„ë¦°, ì˜¤ì§€í›„, ë°°í•˜ë¦°';
    namesEl.value = demo; saveLS(); parseNames();
  });
  document.addEventListener('keydown', (e)=>{ if((e.metaKey||e.ctrlKey) && e.key==='Enter'){ e.preventDefault(); draw(); } });

  // Initial stats
  parseNames();
})();
</script>
</body>
</html>
